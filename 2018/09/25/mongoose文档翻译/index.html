<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>mongoose文档翻译 | 前端圈</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="mongoose 文档翻译[TOC] Getting Started（入门）First be sure you have MongoDB and Node.js installed. Next install Mongoose from the command line using npm: 1npm install mongoose  现在说我们喜欢的小猫，想要记录我们在MongoDB中见过的每">
<meta property="og:type" content="article">
<meta property="og:title" content="mongoose文档翻译">
<meta property="og:url" content="http://yoursite.com/2018/09/25/mongoose%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91/index.html">
<meta property="og:site_name" content="前端圈">
<meta property="og:description" content="mongoose 文档翻译[TOC] Getting Started（入门）First be sure you have MongoDB and Node.js installed. Next install Mongoose from the command line using npm: 1npm install mongoose  现在说我们喜欢的小猫，想要记录我们在MongoDB中见过的每">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2018-09-25T10:28:45.000Z">
<meta property="article:modified_time" content="2019-02-15T04:17:08.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="mongoose 文档翻译">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="前端圈" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">前端圈</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-mongoose文档翻译" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/25/mongoose%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91/" class="article-date">
  <time datetime="2018-09-25T10:28:45.000Z" itemprop="datePublished">2018-09-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      mongoose文档翻译
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="mongoose-文档翻译"><a href="#mongoose-文档翻译" class="headerlink" title="mongoose 文档翻译"></a>mongoose 文档翻译</h1><p>[TOC]</p>
<h3 id="Getting-Started（入门）"><a href="#Getting-Started（入门）" class="headerlink" title="Getting Started（入门）"></a>Getting Started（入门）</h3><p>First be sure you have MongoDB and Node.js installed.</p>
<p>Next install Mongoose from the command line using npm:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mongoose</span><br></pre></td></tr></table></figure>

<p>现在说我们喜欢的小猫，想要记录我们在MongoDB中见过的每只小猫。我们需要做的第一件事是在项目中包含mongoose，并在我们本地运行的MongoDB实例上打开与测试数据库的连接。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; getting-started.js</span><br><span class="line">var mongoose &#x3D; require(&#39;mongoose&#39;);</span><br><span class="line">mongoose.connect(&#39;mongodb:&#x2F;&#x2F;localhost&#x2F;test&#39;);</span><br></pre></td></tr></table></figure>
<p>我们与在localhost上运行的测试数据库有挂起的连接。如果我们成功连接或发生连接错误，我们现在需要收到通知：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var db &#x3D; mongoose.connection;</span><br><span class="line">db.on(&#39;error&#39;, console.error.bind(console, &#39;connection error:&#39;));</span><br><span class="line">db.once(&#39;open&#39;, function() &#123;</span><br><span class="line">  &#x2F;&#x2F; we&#39;re connected!</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>一旦我们的连接打开，我们的回调就会被调用。为简洁起见，我们假设所有以下代码都在此回调中。</p>
<p>使用Mongoose，一切都来自Schema。让我们来参考它并定义我们的小猫。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var kittySchema &#x3D; new mongoose.Schema(&#123;</span><br><span class="line">  name: String</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>到现在为止还挺好。我们有一个带有一个属性name的模式，它将是一个String。下一步是将模式编译为模型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var Kitten &#x3D; mongoose.model(&#39;Kitten&#39;, kittySchema);</span><br></pre></td></tr></table></figure>
<p>模型是用于构造文档的类。在这种情况下，每个文档都将是一个小猫，其属性和行为在我们的模式中声明。让我们创建一个小猫文件，代表我们刚刚在人行道上遇到的小家伙：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var silence &#x3D; new Kitten(&#123; name: &#39;Silence&#39; &#125;);</span><br><span class="line">console.log(silence.name); &#x2F;&#x2F; &#39;Silence&#39;</span><br></pre></td></tr></table></figure>

<p>小猫可以喵喵叫，让我们来看看如何在我们的文档中添加“说话”功能：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; NOTE: methods must be added to the schema before compiling it with mongoose.model()</span><br><span class="line">&#x2F;&#x2F;注意：在使用mongoose.model（）编译方法之前，必须将方法添加到模式中</span><br><span class="line">kittySchema.methods.speak &#x3D; function () &#123;</span><br><span class="line">  var greeting &#x3D; this.name</span><br><span class="line">    ? &quot;Meow name is &quot; + this.name</span><br><span class="line">    : &quot;I don&#39;t have a name&quot;;</span><br><span class="line">  console.log(greeting);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var Kitten &#x3D; mongoose.model(&#39;Kitten&#39;, kittySchema);</span><br></pre></td></tr></table></figure>

<p>添加到模式的methods属性的函数将编译到Model原型中并在每个文档实例上公开：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var fluffy &#x3D; new Kitten(&#123; name: &#39;fluffy&#39; &#125;);</span><br><span class="line">fluffy.speak(); &#x2F;&#x2F; &quot;Meow name is fluffy&quot;</span><br></pre></td></tr></table></figure>
<p>我们有说话的小猫！但是我们还没有向MongoDB保存任何内容。可以通过调用其save方法将每个文档保存到数据库中。如果发生任何回调，回调的第一个参数将是错误。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fluffy.save(function (err, fluffy) &#123;</span><br><span class="line">    if (err) return console.error(err);</span><br><span class="line">    fluffy.speak();</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<p>我们想要显示我们见过的所有小猫,我们可以通过我们的Kitten模型访问所有小猫文档。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Kitten.find(function (err, kittens) &#123;</span><br><span class="line">  if (err) return console.error(err);</span><br><span class="line">  console.log(kittens);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>我们刚刚将数据库中的所有小猫记录到控制台。如果我们想按名称过滤我们的小猫，Mongoose支持MongoDB丰富的查询语法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Kitten.find(&#123; name: &#x2F;^fluff&#x2F; &#125;, callback);</span><br></pre></td></tr></table></figure>

<p>这将搜索具有以“Fluff”开头的name属性的所有文档，并将结果作为小猫数组返回给回调。祝贺这是我们快速启动的结束。我们使用Mongoose在MongoDB中创建了一个模式，添加了一个自定义文档方法，保存和查询的小猫。转到指南或API文档了解更多信息。</p>
<h3 id="Guides-指南"><a href="#Guides-指南" class="headerlink" title="Guides 指南"></a>Guides 指南</h3><p>Mongoose指南提供有关Mongoose核心概念的详细教程，并将Mongoose与外部工具和框架集成在一起。</p>
<h4 id="Schemas"><a href="#Schemas" class="headerlink" title="Schemas"></a>Schemas</h4><p>如果您还没有这样做，请花一点时间阅读快速入门，了解Mongoose的工作原理。如果您要从4.x迁移到5.x，请花点时间阅读迁移指南。</p>
<p><strong>Defining your schema （定义架构）</strong>  </p>
<p>Everything in Mongoose starts with a Schema. Each schema maps to a MongoDB collection and defines the shape of the documents within that collection.</p>
<p>Mongoose中的所有内容都以Schema开头。每个模式都映射到MongoDB集合，并定义该集合中文档的形状。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var mongoose &#x3D; require(&#39;mongoose&#39;);</span><br><span class="line">  var Schema &#x3D; mongoose.Schema;</span><br><span class="line"></span><br><span class="line">  var blogSchema &#x3D; new Schema(&#123;</span><br><span class="line">    title:  String,</span><br><span class="line">    author: String,</span><br><span class="line">    body:   String,</span><br><span class="line">    comments: [&#123; body: String, date: Date &#125;],</span><br><span class="line">    date: &#123; type: Date, default: Date.now &#125;,</span><br><span class="line">    hidden: Boolean,</span><br><span class="line">    meta: &#123;</span><br><span class="line">      votes: Number,</span><br><span class="line">      favs:  Number</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<p>允许的SchemaTypes是：</p>
<ul>
<li>String</li>
<li>Number</li>
<li>Date</li>
<li>Buffer</li>
<li>Boolean</li>
<li>Mixed</li>
<li>ObjectId</li>
<li>Array</li>
<li>Decimal128</li>
<li>Map</li>
</ul>
<p><a href="https://mongoosejs.com/docs/schematypes.html#schematypes" target="_blank" rel="noopener"><strong>SchemaTypes 的更多信息</strong></a></p>
<p>模式不仅定义了文档的结构和属性的转换，还定义了文档实例方法，静态模型方法，复合索引和称为中间件的文档生命周期钩子。</p>
<p>Creating a model 创建模型</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/09/25/mongoose%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91/" data-id="ckcjwb5nb0003wv979fwxgdts" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongoose-%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91/" rel="tag">mongoose 文档翻译</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/09/26/%E7%94%9F%E6%88%90hexo%E7%9B%AE%E5%BD%95%E7%9A%84%E5%B7%A5%E5%85%B7-koa-generator/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          生成hexo目录的工具 koa-generator
        
      </div>
    </a>
  
  
    <a href="/2018/09/25/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91%E4%B9%8B%E5%88%A9%E7%94%A8%E6%9C%AC%E5%9C%B0%E7%BC%93%E5%AD%98%E6%8F%90%E5%89%8D%E6%B8%B2%E6%9F%93%E7%95%8C%E9%9D%A2/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">小程序开发之利用本地缓存提前渲染界面</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongoose-%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91/" rel="tag">mongoose 文档翻译</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/mongoose-%E6%96%87%E6%A1%A3%E7%BF%BB%E8%AF%91/" style="font-size: 10px;">mongoose 文档翻译</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/02/15/hello-world/">类数组对象</a>
          </li>
        
          <li>
            <a href="/2019/02/15/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8E%E5%9B%9B%E6%AC%A1%E6%8F%A1%E6%89%8B/">TCP三次握手与四次握手</a>
          </li>
        
          <li>
            <a href="/2019/02/15/%E7%B1%BB%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1/">类数组对象</a>
          </li>
        
          <li>
            <a href="/2018/12/17/node%E9%9D%A2%E8%AF%95/">node面试</a>
          </li>
        
          <li>
            <a href="/2018/09/27/%E4%BA%91%E5%BC%80%E5%8F%91%E5%88%9D%E6%8E%A2/">云开发初探</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>